---
title: 'STAT 636: Final Project'
author: "Katie Hill, Asmita Nagila, Jerrin Wiley"
date: "`r Sys.Date()`"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(dplyr)
library(ggplot2) #Plots for visualization
library(glmnet)
library(corrplot) #Correlation Heatmap
library(pROC) #Roc Curve
```

## Project Data Source

<https://archive.ics.uci.edu/dataset/697/predict+students+dropout+and+academic+success>

Instances: 4424

Features: 36

Goal: Classify Students into 3 categories: Dropout, Enrolled, and Graduate

## Data Import

Import Data

```{r}
data <- read.csv("data.csv",sep=";")
attach(data)
```

```{r}
head(data)
```

Check for Missing Values

```{r}
which(is.na(data))
```

No line is missing data

Convert Target values to numerical values. Dropout = 1, Enrolled = 2, Graduate = 3

```{r}
model_data <- data
model_data$Target <- as.numeric(factor(Target))
```

## Data Exploration

```{r}
ggplot(data=data)+geom_bar(mapping=aes(x=Target))
```

Build function to graph distribution of feature by target

```{r}
FeatureVsTarget = function(feature,name){
  print(ggplot(data=data)+
          geom_boxplot(mapping=aes(x=reorder(Target,feature,FUN=median),y=feature))+xlab("Target")+ylab(name))
}
```

```{r}
FeatureVsTarget(Admission.grade)
```

Plot Features

```{r}
data_col <- colnames(data)
for(i in 1:ncol(data)){
  FeatureVsTarget(data[,i], data_col[i])
}
```

```{r}
out.width="300%"
```

```{r fig.height=15, fig.width=15}
correlations <- cor(data[,-37])
print(corrplot(correlations))
```

## Data Split

70% train, 30% split (Will not be used for feature selection, k-fold cross-validation will be)

```{r}
sample <- sample(c(TRUE,FALSE),nrow(data),replace=TRUE,prob=c(0.7,0.3))
train <- data[sample,]
test <- data[!sample,]
```

## Feature Selection

```{r}
y <- model_data$Target
x <- data.matrix(subset(model_data,select=-Target))
```

```{r}
cv.lambda.lasso <- cv.glmnet(x,y,alpha=1)
plot(cv.lambda.lasso)
```

```{r}
cv.lambda.lasso
```

```{r}
plot(cv.lambda.lasso$glmnet.fit,"lambda",label=FALSE)
```

```{r}
model$lambda
```
